---
title: "Write title here"

author: 
  - Sevnur Kulak
  - Dongqi Bi
thanks: "Code and data are available at: https://github.com/hellowoshibb/STA304_paper3"
date: "`r format(Sys.time(), '%d %B %Y')`"
abstract: "write abstract here"
output: 
  bookdown::pdf_document2:
    fig_caption: yes
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(hash)
library(dplyr)
library(forcats)
library(knitr)
library(janitor)
library(tidyverse)
library(tidyr)
library(wrapr)
library(haven)
library(ggplot2)
library(gridExtra)
```

```{r, message=FALSE, cache=TRUE, warning = FALSE, echo = FALSE}
#read gss raw data
gss <- read_csv(here::here("input/data/gss.csv"))
```


```{r, Age-first-child, fig.cap="Distribution of Age of Respondents having their first child ", warning=FALSE, echo=FALSE}

gss_afb <- gss |>
  select(age_at_first_birth, sex) |>
  na.omit()

#gss_afb |>
  #ggplot(mapping = aes(x = age_at_first_birth, fill = sex))+
  #geom_bar()+
  #labs(x = "Age of Respondents having their first child",
       #y = "Number of respondents",
       #fill = "Gender")

gss_afb |>
  filter(sex == "Female") |>
  ggplot(mapping = aes(x = age_at_first_birth, fill=(..count..)/sum(..count..)))+
  geom_bar(aes(y = (..count..)/sum(..count..)))+
  labs(x = "Age of Women having their first child",
       y = "Proportion of respondents",
       fill = "Proportion of respondents")
  
gss_afb |>
  filter(sex == "Male") |>
  ggplot(mapping = aes(x = age_at_first_birth, fill=(..count..)/sum(..count..)))+
  geom_bar(aes(y = (..count..)/sum(..count..)))+
  labs(x = "Age of Male having their first child",
       y = "Proportion of respondents",
       fill = "Proportion of respondents")


```